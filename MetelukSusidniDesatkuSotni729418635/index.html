<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.1, maximum-scale=5.0">
    <title>–ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∞ –ì–∞–ª—è–≤–∏–Ω–∞ (Mobile)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&display=swap');

        body {
            margin: 0;
            padding: 0;
            font-family: 'Comic Neue', cursive;
            background-color: #1a1a1a; /* –¢–µ–º–Ω–∏–π —Ñ–æ–Ω –∑–∞ –º–µ–∂–∞–º–∏ –≥—Ä–∏ */
            overflow: hidden; /* –ü—Ä–∏–±–∏—Ä–∞—î–º–æ —Å–∫—Ä–æ–ª —Å—Ç–æ—Ä—ñ–Ω–∫–∏ */
            height: 100vh;
            width: 100vw;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* –ì–æ–ª–æ–≤–Ω–∏–π —ñ–≥—Ä–æ–≤–∏–π —Å–≤—ñ—Ç 1920x1080 */
        #game-world {
            position: absolute;
            left: 50%;
            top: 50%;
            width: 1920px;
            height: 1080px;
            background: linear-gradient(to bottom, #4facfe 0%, #00f2fe 100%);
            overflow: hidden;
            transform-origin: center center;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
            /* Transform –∑–∞–¥–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ JS */
        }

        /* --- –§–û–ù --- */
        .cloud {
            position: absolute;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50px;
            animation: floatClouds 60s linear infinite;
            z-index: 1;
        }
        .cloud::after, .cloud::before { content: ''; position: absolute; background: inherit; border-radius: 50%; }
        
        .c1 { width: 120px; height: 50px; top: 10%; left: -150px; animation-duration: 45s; }
        .c1::after { width: 50px; height: 50px; top: -25px; left: 15px; }
        .c1::before { width: 40px; height: 40px; top: -15px; left: 60px; }

        .c2 { width: 180px; height: 70px; top: 20%; left: -200px; animation-duration: 65s; animation-delay: 5s; }
        .c2::after { width: 70px; height: 70px; top: -35px; left: 25px; }
        .c2::before { width: 60px; height: 60px; top: -25px; left: 90px; }

        @keyframes floatClouds {
            from { transform: translateX(-300px); }
            to { transform: translateX(2000px); } /* –í—ñ–¥–Ω–æ—Å–Ω–æ —à–∏—Ä–∏–Ω–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
        }

        /* –ü–∞–≥–æ—Ä–±–∏ */
        .hill { position: absolute; bottom: -50px; border-radius: 100% 100% 0 0; }
        .hill-1 { width: 70%; height: 45%; left: -10%; background: #66BB6A; z-index: 2; }
        .hill-2 { width: 80%; height: 55%; right: -20%; background: #43A047; z-index: 3; }

        /* –î–µ—Ä–µ–≤–∞ */
        .tree {
            position: absolute;
            bottom: 180px; 
            z-index: 4; 
            font-size: 22rem; 
            filter: drop-shadow(5px 5px 10px rgba(0,0,0,0.4));
            pointer-events: none;
        }
        .tree-1 { left: -20px; transform: rotate(-5deg); }
        .tree-2 { 
            right: 80px;    
            bottom: 280px;  
            transform: rotate(5deg); 
        }

        /* --- –Ü–ù–¢–ï–†–§–ï–ô–° --- */
        #task-panel {
            position: absolute;
            top: 50px; /* –¢—Ä–æ—Ö–∏ –Ω–∏–∂—á–µ –¥–ª—è 1080p */
            left: 50%;
            /* –¶–µ–Ω—Ç—Ä—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ margin, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤ transform –ø—Ä–∏ –∞–Ω—ñ–º–∞—Ü—ñ—ó (—è–∫—â–æ –±—É–¥—É—Ç—å) 
               –∞–ª–µ —Ç—É—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ translate, –±–æ —Ü–µ —Å—Ç–∞—Ç–∏—á–Ω–∏–π UI */
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 30px 50px;
            border-radius: 40px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.25);
            text-align: center;
            z-index: 100;
            border: 8px solid #fff;
            min-width: 800px; /* –ë—ñ–ª—å—à–µ –¥–ª—è 1920px —à–∏—Ä–∏–Ω–∏ */
        }

        #task-text {
            font-size: 2.5rem; /* –ó–±—ñ–ª—å—à–µ–Ω–æ —à—Ä–∏—Ñ—Ç */
            color: #444;
            margin-bottom: 30px;
        }

        #round-target {
            cursor: pointer;
            border-bottom: 3px dashed currentColor;
            transition: transform 0.1s;
            display: inline-block;
        }
        #round-target:active { transform: scale(0.95); }

        #game-area {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 25px;
            margin-bottom: 30px;
        }

        .inequality-sign { font-size: 4rem; color: #999; font-weight: bold; }

        #number-display {
            font-size: 6rem; /* –ó–±—ñ–ª—å—à–µ–Ω–æ */
            color: #333;
            font-weight: bold;
            cursor: pointer;
            padding: 0 20px;
            border-bottom: 4px dashed #ccc;
            min-width: 150px;
        }
        
        #edit-number-input {
            font-size: 4rem; width: 180px; text-align: center; display: none;
            border: 3px solid #2196F3; border-radius: 15px;
        }

        input[type="number"] {
            font-size: 3.5rem; /* –ó–±—ñ–ª—å—à–µ–Ω–æ –¥–ª—è –∑—Ä—É—á–Ω–æ—Å—Ç—ñ –Ω–∞ —Ç–∞—á—ñ */
            padding: 15px;
            width: 180px;
            border: 5px solid #FFCA28;
            border-radius: 20px;
            text-align: center;
            outline: none;
            background: #FFF9C4;
            color: #333;
            transition: 0.3s;
        }
        input[type="number"]:focus { border-color: #FF6F00; transform: scale(1.05); }
        
        .input-error {
            border-color: #e53935 !important;
            background-color: #ffcdd2 !important;
            animation: shake 0.5s;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-15px); }
            75% { transform: translateX(15px); }
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            font-size: 2rem; padding: 15px 50px;
            border: none; border-radius: 60px;
            cursor: pointer; font-family: inherit; font-weight: bold;
            transition: 0.2s; margin: 0 10px;
        }
        .btn-check { background-color: #66BB6A; color: white; box-shadow: 0 8px 0 #388E3C; }
        .btn-check:active { transform: translateY(4px); box-shadow: none; }
        
        .btn-next { background-color: #29B6F6; color: white; box-shadow: 0 8px 0 #0277BD; display: none; }
        
        .btn-regen {
            background-color: #FF9800; color: white;
            padding: 15px 20px;
            font-size: 2rem;
            box-shadow: 0 8px 0 #F57C00;
        }
        .btn-regen:active { transform: translateY(4px); box-shadow: none; }

        /* --- –ï–õ–ï–ú–ï–ù–¢–ò –°–¶–ï–ù–ò --- */
        .flower {
            position: absolute;
            font-size: 5rem; /* –ö–≤—ñ—Ç–∏ –±—ñ–ª—å—à—ñ */
            z-index: 5;
            filter: drop-shadow(0 5px 5px rgba(0,0,0,0.2));
            transform-origin: bottom center;
            animation: sway 3s ease-in-out infinite alternate;
        }
        .f1 { left: 15%; bottom: 120px; animation-delay: 0s; font-size: 6rem; }
        .f2 { left: 30%; bottom: 80px; animation-delay: 1s; }
        .f3 { left: 50%; bottom: 150px; animation-delay: 2s; font-size: 5.5rem; }
        .f4 { left: 70%; bottom: 60px; animation-delay: 0.5s; }
        .f5 { left: 85%; bottom: 140px; animation-delay: 1.5s; font-size: 6.5rem; }

        @keyframes sway {
            0% { transform: rotate(-6deg); }
            100% { transform: rotate(6deg); }
        }

        #butterfly {
            position: absolute;
            font-size: 8rem; /* –ú–µ—Ç–µ–ª–∏–∫ –±—ñ–ª—å—à–∏–π */
            z-index: 50;
            filter: drop-shadow(0 15px 20px rgba(0,0,0,0.3));
            pointer-events: none;
            /* Transition –±—É–¥–µ –¥–æ–¥–∞–≤–∞—Ç–∏—Å—è —á–µ—Ä–µ–∑ JS */
        }

        .particle {
            position: absolute; width: 20px; height: 20px; border-radius: 50%;
            z-index: 999; pointer-events: none;
        }

    </style>
</head>
<body>

    <div id="game-world">
        <div class="cloud c1"></div>
        <div class="cloud c2"></div>

        <div class="hill hill-1"></div>
        <div class="hill hill-2"></div>

        <div class="tree tree-1">üå≥</div>
        <div class="tree tree-2">üå≤</div>

        <div class="flower f1">üåº</div>
        <div class="flower f2">üå∑</div>
        <div class="flower f3">üåª</div>
        <div class="flower f4">üå∫</div>
        <div class="flower f5">üåπ</div>

        <div id="butterfly">ü¶ã</div>

        <div id="task-panel">
            <div id="task-text">
                –°—É—Å—ñ–¥–Ω—ñ <span id="round-target" onclick="toggleMode()" title="–ù–∞—Ç–∏—Å–Ω–∏, —â–æ–± –∑–º—ñ–Ω–∏—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è">...</span>
            </div>
            
            <div id="game-area">
                <input type="number" id="input-left" placeholder="?">
                <span class="inequality-sign">&lt;</span>
                
                <div id="number-wrapper" style="display:inline-block">
                    <div id="number-display" title="–ö–ª—ñ–∫–Ω–∏, —â–æ–± –∑–º—ñ–Ω–∏—Ç–∏ —á–∏—Å–ª–æ">000</div>
                    <input type="number" id="edit-number-input">
                </div>
                
                <span class="inequality-sign">&lt;</span>
                <input type="number" id="input-right" placeholder="?">

                <button class="btn btn-regen" onclick="generateTask(true)" title="–Ü–Ω—à–µ –∑–∞–≤–¥–∞–Ω–Ω—è">üîÑ</button>
            </div>

            <button class="btn btn-check" onclick="checkAnswer()">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏</button>
            <button class="btn btn-next" onclick="nextTask()" id="next-btn">–î–∞–ª—ñ ‚û°</button>
        </div>
    </div>

<script>
    // --- SCALING LOGIC (–ú–ê–°–®–¢–ê–ë–£–í–ê–ù–ù–Ø) ---
    function resizeGame() {
        const gameWorld = document.getElementById('game-world');
        const vw = window.innerWidth;
        const vh = window.innerHeight;
        
        // –ë–∞–∑–æ–≤—ñ —Ä–æ–∑–º—ñ—Ä–∏ –≥—Ä–∏
        const baseW = 1920;
        const baseH = 1080;

        // –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –º–∞—Å—à—Ç–∞–±—É (fit screen with slight padding)
        const scale = Math.min(vw / baseW, vh / baseH) * 0.95;

        // –ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó
        gameWorld.style.transform = `translate(-50%, -50%) scale(${scale})`;
    }

    // –°–ª—É—Ö–∞—á—ñ –ø–æ–¥—ñ–π –¥–ª—è –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è
    window.addEventListener('resize', resizeGame);
    window.addEventListener('load', resizeGame);


    // --- –ó–í–£–ö ---
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playSound(type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const now = audioCtx.currentTime;
        
        if (type === 'success') {
            const notes = [523.25, 659.25, 783.99, 1046.50];
            notes.forEach((freq, i) => {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = 'sine';
                osc.frequency.setValueAtTime(freq, now);
                gain.gain.setValueAtTime(0, now);
                gain.gain.linearRampToValueAtTime(0.1, now + 0.05); 
                gain.gain.exponentialRampToValueAtTime(0.001, now + 1.5);
                osc.connect(gain);
                gain.connect(audioCtx.destination);
                osc.start(now + i * 0.08); osc.stop(now + 2);
            });
        } else if (type === 'error') {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'triangle';
            osc.frequency.setValueAtTime(150, now);
            osc.frequency.linearRampToValueAtTime(100, now + 0.3);
            gain.gain.setValueAtTime(0.2, now);
            gain.gain.linearRampToValueAtTime(0, now + 0.3);
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start(); osc.stop(now + 0.4);
        }
    }

    // --- –õ–û–ì–Ü–ö–ê –ì–†–ò ---
    let currentNumber = 0;
    let currentTarget = 'tens';
    let currentFlowerIndex = 0;
    
    const flowers = document.querySelectorAll('.flower');
    const butterfly = document.getElementById('butterfly');
    const numberDisplay = document.getElementById('number-display');
    const editInput = document.getElementById('edit-number-input');
    const inputLeft = document.getElementById('input-left');
    const inputRight = document.getElementById('input-right');
    const targetText = document.getElementById('round-target');

    function init() {
        resizeGame(); // –ú–∞—Å—à—Ç–∞–±—É—î–º–æ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ
        const start = flowers[Math.floor(Math.random() * flowers.length)];
        currentFlowerIndex = Array.from(flowers).indexOf(start);
        landButterflyOn(start, 0);
        generateTask(true);
    }

    // –†—É—Ö
    function flyToRandomFlower() {
        let nextIndex;
        do { nextIndex = Math.floor(Math.random() * flowers.length); } while (nextIndex === currentFlowerIndex);
        currentFlowerIndex = nextIndex;
        
        // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ –ø–æ–≤—ñ—Ç—Ä—è –≤—ñ–¥–Ω–æ—Å–Ω–æ 1920x1080
        const airX = Math.random() * (1920 - 200) + 100;
        const airY = Math.random() * (1080 / 2);
        
        butterfly.style.transition = "all 1.5s ease-in-out";
        butterfly.style.left = `${airX}px`;
        butterfly.style.top = `${airY}px`;
        butterfly.style.transform = `scale(1.2) rotate(${Math.random() * 30 - 15}deg)`;

        setTimeout(() => landButterflyOn(flowers[nextIndex], 1.5), 1200);
    }

    function landButterflyOn(flower, duration) {
        // –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –ø–æ–∑–∏—Ü—ñ—ó –ë–ï–ó getBoundingClientRect
        // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ offsetLeft/Top –≤—ñ–¥–Ω–æ—Å–Ω–æ –±–∞—Ç—å–∫–∞ (#game-world)
        const tx = flower.offsetLeft + (flower.offsetWidth / 2) - (butterfly.offsetWidth / 2); // –¶–µ–Ω—Ç—Ä—É—î–º–æ
        const ty = flower.offsetTop - 80; // –¢—Ä–æ—Ö–∏ –≤–∏—â–µ –∫–≤—ñ—Ç–∫–∏
        
        butterfly.style.transition = `all ${duration}s cubic-bezier(0.25, 1, 0.5, 1)`;
        butterfly.style.left = `${tx}px`;
        butterfly.style.top = `${ty}px`;
        butterfly.style.transform = `scale(1) rotate(0deg)`;
    }

    // –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è
    function generateTask(randomizeMode = true) {
        inputLeft.value = ''; inputRight.value = '';
        inputLeft.className = ''; inputRight.className = '';
        document.querySelector('.btn-check').style.display = 'inline-block';
        document.getElementById('next-btn').style.display = 'none';

        if (randomizeMode) {
            currentTarget = Math.random() < 0.5 ? 'tens' : 'hundreds';
        }
        
        updateTargetVisuals();
        generateNumberForMode();
        
        inputLeft.focus();
    }

    function updateTargetVisuals() {
        if (currentTarget === 'tens') {
            targetText.innerText = "–î–ï–°–Ø–¢–ö–ò";
            targetText.style.color = "#E91E63"; 
        } else {
            targetText.innerText = "–°–û–¢–ù–Ü";
            targetText.style.color = "#1565C0"; 
        }
    }

    function generateNumberForMode() {
        if (currentTarget === 'tens') {
            do { currentNumber = Math.floor(Math.random() * 980) + 10; } while (currentNumber % 10 === 0);
        } else {
            do { currentNumber = Math.floor(Math.random() * 890) + 100; } while (currentNumber % 100 === 0);
        }
        updateNumberDisplay(currentNumber);
    }

    function toggleMode() {
        currentTarget = (currentTarget === 'tens') ? 'hundreds' : 'tens';
        updateTargetVisuals();
        generateNumberForMode(); 
        inputLeft.value = ''; inputRight.value = '';
        inputLeft.className = ''; inputRight.className = '';
        document.querySelector('.btn-check').style.display = 'inline-block';
        document.getElementById('next-btn').style.display = 'none';
    }

    function updateNumberDisplay(num) {
        currentNumber = parseInt(num);
        numberDisplay.innerText = currentNumber;
    }
    numberDisplay.addEventListener('click', () => {
        numberDisplay.style.display = 'none';
        editInput.style.display = 'inline-block';
        editInput.value = currentNumber;
        editInput.focus();
    });
    editInput.addEventListener('blur', () => {
        let val = parseInt(editInput.value);
        if (!isNaN(val) && val > 0 && val < 1000) updateNumberDisplay(val);
        editInput.style.display = 'none';
        numberDisplay.style.display = 'inline-block';
    });
    editInput.addEventListener('keypress', (e) => { if(e.key==='Enter') editInput.blur(); });

    function checkAnswer() {
        const valLeft = parseInt(inputLeft.value);
        const valRight = parseInt(inputRight.value);
        
        let cL, cR;
        if (currentTarget === 'tens') {
            cL = Math.floor(currentNumber / 10) * 10; cR = cL + 10;
        } else {
            cL = Math.floor(currentNumber / 100) * 100; cR = cL + 100;
        }

        let isCorrect = (valLeft === cL && valRight === cR);

        if (isCorrect) {
            playSound('success');
            createFireworks();
            flyToRandomFlower();
            document.querySelector('.btn-check').style.display = 'none';
            document.getElementById('next-btn').style.display = 'inline-block';
            document.getElementById('next-btn').focus();
            inputLeft.className = ''; inputRight.className = '';
        } else {
            playSound('error');
            if (valLeft !== cL) inputLeft.classList.add('input-error');
            if (valRight !== cR) inputRight.classList.add('input-error');
            setTimeout(() => { inputLeft.className=''; inputRight.className=''; }, 500);
        }
    }

    function createFireworks() {
        const colors = ['#FFEB3B', '#FF4081', '#00E676', '#03A9F4'];
        
        // –ó–Ω–∞—Ö–æ–¥–∏–º–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ —Ü–µ–Ω—Ç—Ä—É –ø–∞–Ω–µ–ª—ñ –∑–∞–≤–¥–∞–Ω—å –≤—ñ–¥–Ω–æ—Å–Ω–æ game-world
        const taskPanel = document.getElementById('task-panel');
        const gameArea = document.getElementById('game-area');
        
        // –û—Å–∫—ñ–ª—å–∫–∏ game-world - —Ü–µ position context, offsetLeft –¥–∞—Å—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ –≤—ñ–¥–Ω–æ—Å–Ω–æ –Ω—å–æ–≥–æ
        // –ê–ª–µ gameArea –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ taskPanel. –¢—Ä–µ–±–∞ –¥–æ–¥–∞—Ç–∏ –∑–º—ñ—â–µ–Ω–Ω—è.
        const cx = taskPanel.offsetLeft + gameArea.offsetLeft + (gameArea.offsetWidth / 2);
        const cy = taskPanel.offsetTop + gameArea.offsetTop + (gameArea.offsetHeight / 2);

        const gameWorld = document.getElementById('game-world');

        for (let i = 0; i < 50; i++) {
            const p = document.createElement('div');
            p.classList.add('particle');
            gameWorld.appendChild(p); // –î–æ–¥–∞—î–º–æ —á–∞—Å—Ç–∏–Ω–∫–∏ —Å–∞–º–µ –≤ #game-world
            
            p.style.background = colors[Math.floor(Math.random()*colors.length)];
            p.style.left = cx+'px'; 
            p.style.top = cy+'px';
            
            const angle = Math.random()*Math.PI*2;
            const vel = 10 + Math.random()*20; // –®–≤–∏–¥—à–µ –¥–ª—è –≤–µ–ª–∏–∫–æ–≥–æ –µ–∫—Ä–∞–Ω–∞
            const vx = Math.cos(angle)*vel; 
            const vy = Math.sin(angle)*vel;
            
            p.animate([
                { transform: `translate(0,0)`, opacity: 1 },
                { transform: `translate(${vx*20}px, ${vy*20+150}px)`, opacity: 0 }
            ], { duration: 1000, easing: 'ease-out' }).onfinish = () => p.remove();
        }
    }

    function nextTask() { generateTask(true); }

    inputLeft.addEventListener('keypress', (e)=>{if(e.key==='Enter') inputRight.focus();});
    inputRight.addEventListener('keypress', (e)=>{if(e.key==='Enter') checkAnswer();});
    
    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —Ä–æ–∑–º—ñ—Ä –º–µ—Ç–µ–ª–∏–∫–∞ –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–æ–±—Ä–∞–∂–µ–Ω—å/—Å—Ç–∏–ª—ñ–≤ –¥–ª—è –∫–æ—Ä–µ–∫—Ç–Ω–æ—ó –ø–æ—Å–∞–¥–∫–∏
    window.onload = function() {
        resizeGame();
        init();
    };

</script>
</body>
</html>